= Codion Application Framework
:dir-source: demos/manual/src/main/java
:dir-chinook-source: demos/chinook/src/main/java

image::documentation/src/docs/asciidoc/images/codion-logo.png[Codion logo,350]
image::https://github.com/bjorndarri/codion/workflows/Java%20CI/badge.svg[CI]

Codion is a minimalistic full-stack Java rich client CRUD application framework based solely on link:++https://en.wikipedia.org/wiki/Java_Platform,_Standard_Edition++[Java SE] components, it includes:

* Simple domain modelling in plain Java code.
* Integrated JUnit testing of the domain model.
* A minimal but complete JDBC abstraction layer.
* A straight forward and simple way of wiring together a rich Swing client on top of the domain model, all done in plain Java code.
* Clients are run with either a local JDBC connection or served by a featherweight RMI server.
* Integrated JasperReports support.
* ...and much more.

== Domain model
The domain model in Codion is based on concepts from entity relationship diagrams, *entities* and *properties*. Defining the domain model is done in plain Java code, no annotations or XML is involved.

We start by extending the *Domain* class, with a couple of convenient static imports (skipping the rest for brevity).
[source,java]
----
import static is.codion.framework.domain.entity.KeyGenerators.automatic;
import static is.codion.framework.domain.property.Properties.columnProperty;
import static is.codion.framework.domain.property.Properties.primaryKeyProperty;

public class StoreMinimal extends Domain {
----

Then we define string constants for the entity and its properties (referred to as *entityIds* and *propertyIds*), which are used whenever we need to refer to the entity type and its properties.
[source,java]
----
  public static final String T_CUSTOMER = "store.customer";
  public static final String CUSTOMER_ID = "id";
  public static final String CUSTOMER_FIRST_NAME = "first_name";
  public static final String CUSTOMER_LAST_NAME = "last_name";
  public static final String CUSTOMER_EMAIL = "email";
  public static final String CUSTOMER_IS_ACTIVE = "is_active";
----

And finally we define an entity using the *entityId* and *propertyIds*.
[source,java]
----
  public StoreMinimal() {
    define(T_CUSTOMER,
            primaryKeyProperty(CUSTOMER_ID, Types.BIGINT),
            columnProperty(CUSTOMER_FIRST_NAME, Types.VARCHAR, "First name")
                    .nullable(false).maximumLength(40),
            columnProperty(CUSTOMER_LAST_NAME, Types.VARCHAR, "Last name")
                    .nullable(false).maximumLength(40),
            columnProperty(CUSTOMER_EMAIL, Types.VARCHAR, "Email"),
            columnProperty(CUSTOMER_IS_ACTIVE, Types.BOOLEAN, "Is active")
                    .defaultValue(true))
            .keyGenerator(automatic("store.customer"))
            .stringProvider(new StringProvider(CUSTOMER_LAST_NAME)
                    .addText(", ").addValue(CUSTOMER_FIRST_NAME))
            .caption("Customer");
  }
}
----

Integrated JUnit testing harness for the domain model.

[source,java]
----
public class StoreMinimalTest extends EntityTestUnit {

  public StoreMinimalTest() {
    super(StoreMinimal.class.getName());
  }

  @Test
  public void customer() throws Exception {
    test(Store.T_CUSTOMER);
  }
}
----

== Database access

The *EntityConnection* interface defines the database layer. There are three implementations available; local, which is based on a direct JDBC connection (used below), RMI and HTTP which are both served by the Codion EntityServer.

[source,java]
----
Database database =
        new H2DatabaseProvider().createDatabase("jdbc:h2:mem:h2db");
EntityConnectionProvider connectionProvider =
        new LocalEntityConnectionProvider(database)
                .setDomainClassName(StoreMinimal.class.getName())
                .setUser(Users.parseUser("scott:tiger"));

EntityConnection connection = connectionProvider.getConnection();

List<Entity> customersNamedJoe =
        connection.select(T_CUSTOMER, CUSTOMER_FIRST_NAME, "Joe");

List<Entity> customersWithoutEmail =
        connection.select(selectCondition(T_CUSTOMER, CUSTOMER_EMAIL, LIKE, null));

Entities domainEntities = connection.getEntities();

Entity customer = domainEntities.entity(T_CUSTOMER);
customer.put(CUSTOMER_FIRST_NAME, "Björn");
customer.put(CUSTOMER_LAST_NAME, "Sigurðsson");

Entity.Key customerKey = connection.insert(customer);

customer.put(CUSTOMER_EMAIL, "valid@email.bla");

customer = connection.update(customer);

connection.delete(customerKey);
----

link:https://codion.is[Web Site]
jar {
    doFirst {
        def versionProperties = new Properties()
        versionProperties.put('version', project.version)
        def versionFile = file(sourceSets.main.output.resourcesDir.getAbsolutePath() + '/org/jminor/common/version.properties')
        if (!versionFile.exists()) {
            versionProperties.store(versionFile.newWriter(), null)
        }
        else {
            versionFile.withInputStream { versionProperties.load(it) }
            if (!Objects.equals(project.version, versionProperties.get('version'))) {
                versionProperties.put('version', project.version)
                versionProperties.store(versionFile.newWriter(), null)
            }
        }
    }
}